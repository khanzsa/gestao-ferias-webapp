backend/server.js
import express from 'express';
import cors from 'cors';
import calendarRoutes from './routes/calendar.js';
import sheetsRoutes from './routes/sheets.js';

const app = express();
app.use(cors());
app.use(express.json());

app.use('/api/calendar', calendarRoutes);
app.use('/api/sheets', sheetsRoutes);

const PORT = process.env.PORT || 4000;
app.listen(PORT, () => console.log(`Server running on port ${PORT}`));

import { google } from 'googleapis';

const calendar = google.calendar({ version: 'v3', auth: oauth2Client });

export async function fetchEvents(fromDate, toDate) {
  const res = await calendar.events.list({
    calendarId: process.env.CALENDAR_ID,
    timeMin: fromDate.toISOString(),
    timeMax: toDate.toISOString(),
  });
  return res.data.items;
}

import { google } from 'googleapis';

const sheets = google.sheets({ version: 'v4', auth: oauth2Client });

export async function readRange(range) {
  const res = await sheets.spreadsheets.values.get({
    spreadsheetId: process.env.SHEETS_ID,
    range,
  });
  return res.data.values;
}

export async function writeRange(range, values) {
  await sheets.spreadsheets.values.update({
    spreadsheetId: process.env.SHEETS_ID,
    range,
    valueInputOption: 'USER_ENTERED',
    resource: { values },
  });
}
